@mixin styles
  // inline code (`code`)
  & :not(.code-container) > code
    @apply font-roboto-mono px-[.4em] py-[.2em] text-[85%] rounded-md bg-gray-200

  // code block (```code```)
  & pre
    @apply flex font-roboto-mono -mx-4 my-[1.25em] px-4 py-6 lg:rounded-lg bg-gray-900 text-black overflow-x-auto

    & .code-container
      @apply grow

    // TS playground link
    & .code-container > a
      @apply transition-opacity ease-out opacity-0
      @apply absolute translate-x-[-.625rem] translate-y-[.625rem] text-[0] select-none

      &:is(:hover, :focus-visible)
        @apply opacity-100 no-underline outline-white

      &::after
        @apply content-["Open_in_playground"] text-[1rem]
        @apply focus-scroll-target rounded font-bold bg-white border-2 border-blue-500 px-[.375rem] text-blue-500 shadow

      &:is(:hover, :focus-visible)::after
        @apply text-white bg-blue-500

    &:hover .code-container > a
      @apply opacity-100

    // language label
    &:not(.twoslash) .code-container:not(:first-child)
      @apply pt-5

    & .language-id
      @apply hidden
      @apply transition-colors ease-out text-white/40

    &:is(:hover, :focus-within) .language-id
      @apply text-white/60

    &:not(.twoslash) .language-id
      @apply block absolute -translate-x-0 -translate-y-3
      @apply text-[.8rem] select-none

    &.shiki

      & .line
        @apply min-h-[1rem]

      & .dim
        @apply m-0 p-0
        @apply transition-opacity ease-out opacity-50

      &:hover .dim
        @apply opacity-100

      & .highlight
        @apply bg-white/10 -mx-4 px-4 opacity-100

    &.twoslash

      // type underline indicator
      & .data-lsp
        @apply border-b-[1px] border-dotted
        @apply transition-colors ease-out border-transparent

      &:hover .data-lsp
        @apply border-white/50

      // type info on hover
      & .data-lsp:hover::before
        @apply content-[attr(data-lsp)]
        @apply absolute translate-x-[calc(var(--scroll-x)*-1)] translate-y-[1.1rem] z-10
        @apply px-2 py-1 bg-gray-600 border-2 border-white rounded text-white text-left text-[.875rem] whitespace-pre-wrap

    & code
      @apply text-[.95rem] whitespace-pre

      & a
        @apply no-underline

    // error underline
    & .data-err
      @apply pb-[.2rem]

      // squiggly line, copied from VS Code
      background: url("data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%206%203'%20enable-background%3D'new%200%200%206%203'%20height%3D'3'%20width%3D'6'%3E%3Cg%20fill%3D'%23c94824'%3E%3Cpolygon%20points%3D'5.5%2C0%202.5%2C3%201.1%2C3%204.1%2C0'%2F%3E%3Cpolygon%20points%3D'4%2C0%206%2C2%206%2C0.6%205.4%2C0'%2F%3E%3Cpolygon%20points%3D'0%2C2%201%2C3%202.4%2C3%200%2C0.6'%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E") repeat-x bottom left

    // error message
    & .error-behind
      @apply hidden

    & .error
      @apply block -mx-4 mt-2 mb-1 p-1 pl-3 w-[calc(100%+2rem)] whitespace-pre-wrap
      @apply flex gap-1 bg-red-100 text-dark border-l-4 border-red-700

      & .code
        @apply ml-auto px-2 font-bold

    // --- untested styles --- //

    .query
      margin-bottom: 10px
      color: #137998
      display: inline-block

    .arrow
      /* Transparent background
      background-color: #eee
      position: relative
      top: -7px
      margin-left: 0.1rem

      /* Edges
      border-left: 1px solid #eee
      border-top: 1px solid #eee
      transform: translateY(25%) rotate(45deg)

      /* Size
      height: 8px
      width: 8px

    .popover
      margin-bottom: 10px
      background-color: #eee
      color: #000
      display: inline-block
      padding: 0 0.5rem 0.3rem
      margin-top: 10px
      border-radius: 3px

    .inline-completions ul.dropdown
      display: inline-block
      position: absolute
      width: 240px
      background-color: gainsboro
      color: grey
      padding-top: 4px
      font-family: var(--code-font)
      font-size: 0.8rem
      margin: 0
      padding: 0
      border-left: 4px solid #4b9edd

      &::before
        background-color: #4b9edd
        width: 2px
        position: absolute
        top: -1.2rem
        left: -3px
        content: " "

      li
        overflow-x: hidden
        padding-left: 4px
        margin-bottom: 4px

        &.deprecated
          text-decoration: line-through

        span
          &.result-found
            color: #4b9edd

          &.result
            width: 100px
            color: black
            display: inline-block

  .tag-container
    position: relative

    .twoslash-annotation
      position: absolute
      font-family: "JetBrains Mono", Menlo, Monaco, Consolas, Courier New, monospace
      right: -10px

      /** Default annotation text to 200px
      width: 200px
      color: #187abf
      background-color: #fcf3d9 bb

      p
        text-align: left
        font-size: 0.8rem
        line-height: 0.9rem

      svg
        float: left
        margin-left: -44px

      &.left
        right: auto
        left: -200px

        svg
          float: right
          margin-right: -5px

  pre .logger
    display: flex
    align-items: center
    color: black
    padding: 6px
    padding-left: 8px
    width: calc(100% - 19px)
    white-space: pre-wrap

    svg
      margin-right: 9px

    &.error-log
      background-color: #fee
      border-left: 2px solid #bf1818

    &.warn-log
      background-color: #ffe
      border-left: 2px solid #eae662

    &.log-log
      background-color: #e9e9e9
      border-left: 2px solid #ababab

      svg
        margin-left: 6px
        margin-right: 9px
